{{ template "base" . }}

{{ define "title" }}
	<title>Search result</title>
{{ end }}

{{ define "css" }}
	<style>
		p {
			font-family: 'Montserrat', sans-serif;
		}
		em {
				color: #ccc;
		}
	</style>
{{ end }}

{{ define "content" }}
		<div class="container">
				
				<!-- Result header row -->
				<div class="row mt-3">
						<!-- Dummy left placeholder col -->
						<div class="col-2"></div>

						<!-- Result col -->
						<div class="col-8">

								<!-- Search form by query -->
								<form action="/result" method="get" class="row">
									<input type="hidden" name="csrf_token" value="{{ .CSRFToken }}">

										<!-- Search: query input -->
										<div class="col">
											<input type="text" 
													class="form-control {{ with .Form.Errors.Get "query" }}is-invalid{{ end }}" 
													placeholder="Search.."  
													name="query"
													value="{{ index .StringMap "sessionQuery" }}">

													{{ with .Form.Errors.Get "query" }}
														<div class="text-danger small ms-2">
															{{ . }}
														</div>
													{{ end }}

										</div>

										<!-- Search button block -->
										<div class="col-auto">
											<button type="submit" class="btn btn-outline-primary">Search</button>
										</div>
								</form>

								<!-- Search result hint -->
								<h6 class="mt-3 ms-2">
										Result for: <em>{{ index .StringMap "sessionQuery" }}</em>
								</h6>
						</div>

						<!-- Dummy right placeholder col -->
						<div class="col-2"></div>
				</div>
				
				<!-- Result row -->
				{{ if .Data }}
						{{ $searches := index .Data "search" }}						
						{{ range $searches }}
						
						<div class="row">

								<!-- Dummy left placeholder col -->
								<div class="col-2"></div>

								<!-- Result view block -->
								<div class="col-8">
									<div class="card">
											<div class="card-body">
												<h5 class="card-title">{{ .Query }}</h5>
												<p class="card-text">{{ with .Description }} {{ . }} {{ end }}</p>
												<p class="card-subtitle mb-2 text-muted text-small">created: {{ .CreatedAt }}</p>
												<p class="card-subtitle mb-2 text-muted text-small">updated: {{ .UpdatedAt }}</p>
												<a href="{{ with .Link }} {{ . }} {{ end }}" class="card-link"><i class="bi-alarm"></i>source</a>
											</div>
									</div>
								</div>

								<!-- Dummy right placeholder col -->
								<div class="col-2"></div>
						</div>
						{{ end }}

				{{ else }}

						<div class="row">
							<div class="col-2"></div>
							<div class="col-8">
									<div class="card">
											<div class="card-body">
													<h5 class="card-title">No result</h5>
											</div>
									</div>
							</div>
							<div class="col-2"></div>
						</div>

				{{ end }}
		</div>
{{ end }}
